const taught = {
    "1-T-SS": { visualFileName: "1VTSS.jpg", audioFileName: "1ATSS.mp3", vC: "Simple", aC: "Simple" },
    "2-T-SS": { visualFileName: "2VTSS.jpg", audioFileName: "2ATSS.mp3", vC: "Simple", aC: "Simple" },
    "3-T-SS": { visualFileName: "3VTSS.jpg", audioFileName: "3ATSS.mp3", vC: "Simple", aC: "Simple" },
    "4-T-SS": { visualFileName: "4VTSS.jpg", audioFileName: "4ATSS.mp3", vC: "Simple", aC: "Simple" },
    "5-T-SS": { visualFileName: "5VTSS.jpg", audioFileName: "5ATSS.mp3", vC: "Simple", aC: "Simple" },
    "6-T-SS": { visualFileName: "6VTSS.jpg", audioFileName: "6ATSS.mp3", vC: "Simple", aC: "Simple" },
    "7-T-SS": { visualFileName: "7VTSS.jpg", audioFileName: "7ATSS.mp3", vC: "Simple", aC: "Simple" },
    "8-T-SS": { visualFileName: "8VTSS.jpg", audioFileName: "8ATSS.mp3", vC: "Simple", aC: "Simple" },
    "9-T-SS": { visualFileName: "9VTSS.jpg", audioFileName: "9ATSS.mp3", vC: "Simple", aC: "Simple" },
    "10-T-SS": { visualFileName: "10VTSS.jpg", audioFileName: "10ATSS.mp3", vC: "Simple", aC: "Simple" },
    "11-T-SS": { visualFileName: "11VTSS.jpg", audioFileName: "11ATSS.mp3", vC: "Simple", aC: "Simple" },
    "12-T-SS": { visualFileName: "12VTSS.jpg", audioFileName: "12ATSS.mp3", vC: "Simple", aC: "Simple" },
    "13-T-SS": { visualFileName: "13VTSS.jpg", audioFileName: "13ATSS.mp3", vC: "Simple", aC: "Simple" },
    "14-T-SS": { visualFileName: "14VTSS.jpg", audioFileName: "14ATSS.mp3", vC: "Simple", aC: "Simple" },
    "15-T-SS": { visualFileName: "15VTSS.jpg", audioFileName: "15ATSS.mp3", vC: "Simple", aC: "Simple" },
    "16-T-SC": { visualFileName: "16VTSC.jpg", audioFileName: "16ATSC.mp3", vC: "Simple", aC: "Complex" },
    "17-T-SC": { visualFileName: "17VTSC.jpg", audioFileName: "17ATSC.mp3", vC: "Simple", aC: "Complex" },
    "18-T-SC": { visualFileName: "18VTSC.jpg", audioFileName: "18ATSC.mp3", vC: "Simple", aC: "Complex" },
    "19-T-SC": { visualFileName: "19VTSC.jpg", audioFileName: "19ATSC.mp3", vC: "Simple", aC: "Complex" },
    "20-T-SC": { visualFileName: "20VTSC.jpg", audioFileName: "20ATSC.mp3", vC: "Simple", aC: "Complex" },
    "21-T-SC": { visualFileName: "21VTSC.jpg", audioFileName: "21ATSC.mp3", vC: "Simple", aC: "Complex" },
    "22-T-SC": { visualFileName: "22VTSC.jpg", audioFileName: "22ATSC.mp3", vC: "Simple", aC: "Complex" },
    "23-T-SC": { visualFileName: "23VTSC.jpg", audioFileName: "23ATSC.mp3", vC: "Simple", aC: "Complex" },
    "24-T-SC": { visualFileName: "24VTSC.jpg", audioFileName: "24ATSC.mp3", vC: "Simple", aC: "Complex" },
    "25-T-SC": { visualFileName: "25VTSC.jpg", audioFileName: "25ATSC.mp3", vC: "Simple", aC: "Complex" },
    "26-T-SC": { visualFileName: "26VTSC.jpg", audioFileName: "26ATSC.mp3", vC: "Simple", aC: "Complex" },
    "27-T-SC": { visualFileName: "27VTSC.jpg", audioFileName: "27ATSC.mp3", vC: "Simple", aC: "Complex" },
    "28-T-SC": { visualFileName: "28VTSC.jpg", audioFileName: "28ATSC.mp3", vC: "Simple", aC: "Complex" },
    "29-T-SC": { visualFileName: "29VTSC.jpg", audioFileName: "29ATSC.mp3", vC: "Simple", aC: "Complex" },
    "30-T-SC": { visualFileName: "30VTSC.jpg", audioFileName: "30ATSC.mp3", vC: "Simple", aC: "Complex" },
    "31-T-CS": { visualFileName: "31VTCS.jpg", audioFileName: "31ATCS.mp3", vC: "Complex", aC: "Simple" },
    "32-T-CS": { visualFileName: "32VTCS.jpg", audioFileName: "32ATCS.mp3", vC: "Complex", aC: "Simple" },
    "33-T-CS": { visualFileName: "33VTCS.jpg", audioFileName: "33ATCS.mp3", vC: "Complex", aC: "Simple" },
    "34-T-CS": { visualFileName: "34VTCS.jpg", audioFileName: "34ATCS.mp3", vC: "Complex", aC: "Simple" },
    "35-T-CS": { visualFileName: "35VTCS.jpg", audioFileName: "35ATCS.mp3", vC: "Complex", aC: "Simple" },
    "36-T-CS": { visualFileName: "36VTCS.jpg", audioFileName: "36ATCS.mp3", vC: "Complex", aC: "Simple" },
    "37-T-CS": { visualFileName: "37VTCS.jpg", audioFileName: "37ATCS.mp3", vC: "Complex", aC: "Simple" },
    "38-T-CS": { visualFileName: "38VTCS.jpg", audioFileName: "38ATCS.mp3", vC: "Complex", aC: "Simple" },
    "39-T-CS": { visualFileName: "39VTCS.jpg", audioFileName: "39ATCS.mp3", vC: "Complex", aC: "Simple" },
    "40-T-CS": { visualFileName: "40VTCS.jpg", audioFileName: "40ATCS.mp3", vC: "Complex", aC: "Simple" },
    "41-T-CS": { visualFileName: "41VTCS.jpg", audioFileName: "41ATCS.mp3", vC: "Complex", aC: "Simple" },
    "42-T-CS": { visualFileName: "42VTCS.jpg", audioFileName: "42ATCS.mp3", vC: "Complex", aC: "Simple" },
    "43-T-CS": { visualFileName: "43VTCS.jpg", audioFileName: "43ATCS.mp3", vC: "Complex", aC: "Simple" },
    "44-T-CS": { visualFileName: "44VTCS.jpg", audioFileName: "44ATCS.mp3", vC: "Complex", aC: "Simple" },
    "45-T-CS": { visualFileName: "45VTCS.jpg", audioFileName: "45ATCS.mp3", vC: "Complex", aC: "Simple" },
    "46-T-CC": { visualFileName: "46VTCC.jpg", audioFileName: "46ATCC.mp3", vC: "Complex", aC: "Complex" },
    "47-T-CC": { visualFileName: "47VTCC.jpg", audioFileName: "47ATCC.mp3", vC: "Complex", aC: "Complex" },
    "48-T-CC": { visualFileName: "48VTCC.jpg", audioFileName: "48ATCC.mp3", vC: "Complex", aC: "Complex" },
    "49-T-CC": { visualFileName: "49VTCC.jpg", audioFileName: "49ATCC.mp3", vC: "Complex", aC: "Complex" },
    "50-T-CC": { visualFileName: "50VTCC.jpg", audioFileName: "50ATCC.mp3", vC: "Complex", aC: "Complex" },
    "51-T-CC": { visualFileName: "51VTCC.jpg", audioFileName: "51ATCC.mp3", vC: "Complex", aC: "Complex" },
    "52-T-CC": { visualFileName: "52VTCC.jpg", audioFileName: "52ATCC.mp3", vC: "Complex", aC: "Complex" },
    "53-T-CC": { visualFileName: "53VTCC.jpg", audioFileName: "53ATCC.mp3", vC: "Complex", aC: "Complex" },
    "54-T-CC": { visualFileName: "54VTCC.jpg", audioFileName: "54ATCC.mp3", vC: "Complex", aC: "Complex" },
    "55-T-CC": { visualFileName: "55VTCC.jpg", audioFileName: "55ATCC.mp3", vC: "Complex", aC: "Complex" },
    "56-T-CC": { visualFileName: "56VTCC.jpg", audioFileName: "56ATCC.mp3", vC: "Complex", aC: "Complex" },
    "57-T-CC": { visualFileName: "57VTCC.jpg", audioFileName: "57ATCC.mp3", vC: "Complex", aC: "Complex" },
    "58-T-CC": { visualFileName: "58VTCC.jpg", audioFileName: "58ATCC.mp3", vC: "Complex", aC: "Complex" },
    "59-T-CC": { visualFileName: "59VTCC.jpg", audioFileName: "59ATCC.mp3", vC: "Complex", aC: "Complex" },
    "60-T-CC": { visualFileName: "60VTCC.jpg", audioFileName: "60ATCC.mp3", vC: "Complex", aC: "Complex" },
};

const untaught = {
    "1-U-SS": { visualFileName: "1VUSS.jpg", audioFileName: "1AUSS.mp3", vC: "Simple", aC: "Simple" },
    "2-U-SS": { visualFileName: "2VUSS.jpg", audioFileName: "2AUSS.mp3", vC: "Simple", aC: "Simple" },
    "3-U-SS": { visualFileName: "3VUSS.jpg", audioFileName: "3AUSS.mp3", vC: "Simple", aC: "Simple" },
    "4-U-SS": { visualFileName: "4VUSS.jpg", audioFileName: "4AUSS.mp3", vC: "Simple", aC: "Simple" },
    "5-U-SS": { visualFileName: "5VUSS.jpg", audioFileName: "5AUSS.mp3", vC: "Simple", aC: "Simple" },
    "6-U-SS": { visualFileName: "6VUSS.jpg", audioFileName: "6AUSS.mp3", vC: "Simple", aC: "Simple" },
    "7-U-SS": { visualFileName: "7VUSS.jpg", audioFileName: "7AUSS.mp3", vC: "Simple", aC: "Simple" },
    "8-U-SS": { visualFileName: "8VUSS.jpg", audioFileName: "8AUSS.mp3", vC: "Simple", aC: "Simple" },
    "9-U-SS": { visualFileName: "9VUSS.jpg", audioFileName: "9AUSS.mp3", vC: "Simple", aC: "Simple" },
    "10-U-SS": { visualFileName: "10VUSS.jpg", audioFileName: "10AUSS.mp3", vC: "Simple", aC: "Simple" },
    "11-U-SS": { visualFileName: "11VUSS.jpg", audioFileName: "11AUSS.mp3", vC: "Simple", aC: "Simple" },
    "12-U-SS": { visualFileName: "12VUSS.jpg", audioFileName: "12AUSS.mp3", vC: "Simple", aC: "Simple" },
    "13-U-SS": { visualFileName: "13VUSS.jpg", audioFileName: "13AUSS.mp3", vC: "Simple", aC: "Simple" },
    "14-U-SS": { visualFileName: "14VUSS.jpg", audioFileName: "14AUSS.mp3", vC: "Simple", aC: "Simple" },
    "15-U-SS": { visualFileName: "15VUSS.jpg", audioFileName: "15AUSS.mp3", vC: "Simple", aC: "Simple" },
    "16-U-SC": { visualFileName: "16VUSC.jpg", audioFileName: "16AUSC.mp3", vC: "Simple", aC: "Complex" },
    "17-U-SC": { visualFileName: "17VUSC.jpg", audioFileName: "17AUSC.mp3", vC: "Simple", aC: "Complex" },
    "18-U-SC": { visualFileName: "18VUSC.jpg", audioFileName: "18AUSC.mp3", vC: "Simple", aC: "Complex" },
    "19-U-SC": { visualFileName: "19VUSC.jpg", audioFileName: "19AUSC.mp3", vC: "Simple", aC: "Complex" },
    "20-U-SC": { visualFileName: "20VUSC.jpg", audioFileName: "20AUSC.mp3", vC: "Simple", aC: "Complex" },
    "21-U-SC": { visualFileName: "21VUSC.jpg", audioFileName: "21AUSC.mp3", vC: "Simple", aC: "Complex" },
    "22-U-SC": { visualFileName: "22VUSC.jpg", audioFileName: "22AUSC.mp3", vC: "Simple", aC: "Complex" },
    "23-U-SC": { visualFileName: "23VUSC.jpg", audioFileName: "23AUSC.mp3", vC: "Simple", aC: "Complex" },
    "24-U-SC": { visualFileName: "24VUSC.jpg", audioFileName: "24AUSC.mp3", vC: "Simple", aC: "Complex" },
    "25-U-SC": { visualFileName: "25VUSC.jpg", audioFileName: "25AUSC.mp3", vC: "Simple", aC: "Complex" },
    "26-U-SC": { visualFileName: "26VUSC.jpg", audioFileName: "26AUSC.mp3", vC: "Simple", aC: "Complex" },
    "27-U-SC": { visualFileName: "27VUSC.jpg", audioFileName: "27AUSC.mp3", vC: "Simple", aC: "Complex" },
    "28-U-SC": { visualFileName: "28VUSC.jpg", audioFileName: "28AUSC.mp3", vC: "Simple", aC: "Complex" },
    "29-U-SC": { visualFileName: "29VUSC.jpg", audioFileName: "29AUSC.mp3", vC: "Simple", aC: "Complex" },
    "30-U-SC": { visualFileName: "30VUSC.jpg", audioFileName: "30AUSC.mp3", vC: "Simple", aC: "Complex" },
    "31-U-CS": { visualFileName: "31VUCS.jpg", audioFileName: "31AUCS.mp3", vC: "Complex", aC: "Simple" },
    "32-U-CS": { visualFileName: "32VUCS.jpg", audioFileName: "32AUCS.mp3", vC: "Complex", aC: "Simple" },
    "33-U-CS": { visualFileName: "33VUCS.jpg", audioFileName: "33AUCS.mp3", vC: "Complex", aC: "Simple" },
    "34-U-CS": { visualFileName: "34VUCS.jpg", audioFileName: "34AUCS.mp3", vC: "Complex", aC: "Simple" },
    "35-U-CS": { visualFileName: "35VUCS.jpg", audioFileName: "35AUCS.mp3", vC: "Complex", aC: "Simple" },
    "36-U-CS": { visualFileName: "36VUCS.jpg", audioFileName: "36AUCS.mp3", vC: "Complex", aC: "Simple" },
    "37-U-CS": { visualFileName: "37VUCS.jpg", audioFileName: "37AUCS.mp3", vC: "Complex", aC: "Simple" },
    "38-U-CS": { visualFileName: "38VUCS.jpg", audioFileName: "38AUCS.mp3", vC: "Complex", aC: "Simple" },
    "39-U-CS": { visualFileName: "39VUCS.jpg", audioFileName: "39AUCS.mp3", vC: "Complex", aC: "Simple" },
    "40-U-CS": { visualFileName: "40VUCS.jpg", audioFileName: "40AUCS.mp3", vC: "Complex", aC: "Simple" },
    "41-U-CS": { visualFileName: "41VUCS.jpg", audioFileName: "41AUCS.mp3", vC: "Complex", aC: "Simple" },
    "42-U-CS": { visualFileName: "42VUCS.jpg", audioFileName: "42AUCS.mp3", vC: "Complex", aC: "Simple" },
    "43-U-CS": { visualFileName: "43VUCS.jpg", audioFileName: "43AUCS.mp3", vC: "Complex", aC: "Simple" },
    "44-U-CS": { visualFileName: "44VUCS.jpg", audioFileName: "44AUCS.mp3", vC: "Complex", aC: "Simple" },
    "45-U-CS": { visualFileName: "45VUCS.jpg", audioFileName: "45AUCS.mp3", vC: "Complex", aC: "Simple" },
    "46-U-CC": { visualFileName: "46VUCC.jpg", audioFileName: "46AUCC.mp3", vC: "Complex", aC: "Complex" },
    "47-U-CC": { visualFileName: "47VUCC.jpg", audioFileName: "47AUCC.mp3", vC: "Complex", aC: "Complex" },
    "48-U-CC": { visualFileName: "48VUCC.jpg", audioFileName: "48AUCC.mp3", vC: "Complex", aC: "Complex" },
    "49-U-CC": { visualFileName: "49VUCC.jpg", audioFileName: "49AUCC.mp3", vC: "Complex", aC: "Complex" },
    "50-U-CC": { visualFileName: "50VUCC.jpg", audioFileName: "50AUCC.mp3", vC: "Complex", aC: "Complex" },
    "51-U-CC": { visualFileName: "51VUCC.jpg", audioFileName: "51AUCC.mp3", vC: "Complex", aC: "Complex" },
    "52-U-CC": { visualFileName: "52VUCC.jpg", audioFileName: "52AUCC.mp3", vC: "Complex", aC: "Complex" },
    "53-U-CC": { visualFileName: "53VUCC.jpg", audioFileName: "53AUCC.mp3", vC: "Complex", aC: "Complex" },
    "54-U-CC": { visualFileName: "54VUCC.jpg", audioFileName: "54AUCC.mp3", vC: "Complex", aC: "Complex" },
    "55-U-CC": { visualFileName: "55VUCC.jpg", audioFileName: "55AUCC.mp3", vC: "Complex", aC: "Complex" },
    "56-U-CC": { visualFileName: "56VUCC.jpg", audioFileName: "56AUCC.mp3", vC: "Complex", aC: "Complex" },
    "57-U-CC": { visualFileName: "57VUCC.jpg", audioFileName: "57AUCC.mp3", vC: "Complex", aC: "Complex" },
    "58-U-CC": { visualFileName: "58VUCC.jpg", audioFileName: "58AUCC.mp3", vC: "Complex", aC: "Complex" },
    "59-U-CC": { visualFileName: "59VUCC.jpg", audioFileName: "59AUCC.mp3", vC: "Complex", aC: "Complex" },
    "60-U-CC": { visualFileName: "60VUCC.jpg", audioFileName: "60AUCC.mp3", vC: "Complex", aC: "Complex" },
}

// distribute SS, SC, CS, and CC categories evenly across 6 groups, ensuring at least 20 items per group.
function assignEvenGroups(data, isTaught) {
    const groupNames = isTaught
        ? ["TT", "Taught TU", "Taught UT"]
        : ["UU", "Untaught TU", "Untaught UT"];

    let groups = {
        TT: {},
        UU: {},
        "Taught TU": {},
        "Taught UT": {},
        "Untaught TU": {},
        "Untaught UT": {},
    };

    let itemsByCategory = { SS: [], SC: [], CS: [], CC: [] };

    //sort into respective categories
    Object.keys(data).forEach((item) => {
        let category = item.includes("SS")
            ? "SS"
            : item.includes("SC")
            ? "SC"
            : item.includes("CS")
            ? "CS"
            : "CC";
        itemsByCategory[category].push(item);
    });

    // shuffle each category to randomize selection
    Object.keys(itemsByCategory).forEach((category) => {
        itemsByCategory[category].sort(() => Math.random() - 0.5);
    });

    let totalItems = Object.keys(data).length;
    let itemsPerGroup = Math.max(20, Math.floor(totalItems / 6)); // Ensure at least 20 per group
    let remainingItems = new Set(Object.keys(data));

    // Assign evenly to groups while ensuring balance across categories
    let groupIndex = 0;
    for (let category of ["SS", "SC", "CS", "CC"]) {
        let items = itemsByCategory[category];

        while (items.length > 0) {
            let groupName = groupNames[groupIndex % groupNames.length];

            if (Object.keys(groups[groupName]).length < itemsPerGroup) {
                let item = items.pop();
                groups[groupName][item] = data[item]; // Assign item to group
                remainingItems.delete(item);
            }

            groupIndex++;
        }
    }

    return groups;
}

// Generate the groups for taught and untaught data
const taughtGroups = assignEvenGroups(taught, true);
const untaughtGroups = assignEvenGroups(untaught, false);

// Create six separate JS objects
const TT = taughtGroups["TT"];
const TaughtTU = taughtGroups["Taught TU"];
const TaughtUT = taughtGroups["Taught UT"];
const UU = untaughtGroups["UU"];
const UntaughtTU = untaughtGroups["Untaught TU"];
const UntaughtUT = untaughtGroups["Untaught UT"];

// Function to merge Taught TU visuals with Untaught TU audio
function createCompositeTU(taughtTU, untaughtTU) {
    let TU_Final = {};
    let taughtKeys = Object.keys(taughtTU);
    let untaughtKeys = Object.keys(untaughtTU);

    if (taughtKeys.length !== untaughtKeys.length) {
        console.error("Mismatch between Taught TU and Untaught TU item counts!");
    } else {
        for (let i = 0; i < taughtKeys.length; i++) {
            let taughtItemKey = taughtKeys[i];
            let untaughtItemKey = untaughtKeys[i];

            let taughtItem = taughtTU[taughtItemKey];
            let untaughtItem = untaughtTU[untaughtItemKey];

            TU_Final[taughtItemKey] = {
                itemNumber: taughtItemKey,
                visualFileName: taughtItem.visualFileName, // Take visual from Taught TU
                audioFileName: untaughtItem.audioFileName, // Take audio from Untaught TU
                vC: taughtItem.vC,
                aC: taughtItem.aC,
            };
        }
    }
    return TU_Final;
}

// Function to merge Untaught UT visuals with Taught UT audio
function createCompositeUT(taughtUT, untaughtUT) {
    let UT_Final = {};
    let taughtKeys = Object.keys(taughtUT);
    let untaughtKeys = Object.keys(untaughtUT);

    if (taughtKeys.length !== untaughtKeys.length) {
        console.error("Mismatch between Taught UT and Untaught UT item counts!");
    } else {
        for (let i = 0; i < taughtKeys.length; i++) {
            let taughtItemKey = taughtKeys[i];
            let untaughtItemKey = untaughtKeys[i];

            let taughtItem = taughtUT[taughtItemKey];
            let untaughtItem = untaughtUT[untaughtItemKey];

            UT_Final[untaughtItemKey] = {
                itemNumber: untaughtItemKey,
                visualFileName: untaughtItem.visualFileName, // Take visual from Untaught UT
                audioFileName: taughtItem.audioFileName, // Take audio from Taught UT
                vC: untaughtItem.vC,
                aC: untaughtItem.aC,
            };
        }
    }
    return UT_Final;
}
function shuffleData() {
    console.log("Shuffling data...");

    const taughtGroups = assignEvenGroups(taught, true);
    const untaughtGroups = assignEvenGroups(untaught, false);

    const TT = taughtGroups["TT"];
    const UU = untaughtGroups["UU"];
    const TaughtTU = taughtGroups["Taught TU"];
    const TaughtUT = taughtGroups["Taught UT"];
    const UntaughtTU = untaughtGroups["Untaught TU"];
    const UntaughtUT = untaughtGroups["Untaught UT"];

    const TU_Final = createCompositeTU(TaughtTU, UntaughtTU);
    const UT_Final = createCompositeUT(TaughtUT, UntaughtUT);

    console.log("TT:", Object.keys(TT).length, "items", TT);
    console.log("UU:", Object.keys(UU).length, "items", UU);
    console.log("TU_Final:", Object.keys(TU_Final).length, "items", TU_Final);
    console.log("UT_Final:", Object.keys(UT_Final).length, "items", UT_Final);
}

document.getElementById("shuffle").addEventListener("click", shuffleData);
